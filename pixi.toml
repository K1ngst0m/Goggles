[workspace]
authors = ["mingshi2333 <akashi_asuka@outlook.com>"]
channels = ["conda-forge"]
name = "Goggles"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]

# Default shortcuts
build = { depends-on = ["build-debug"] }
test = { depends-on = ["test-debug"] }
start = { cmd = "./build/debug/bin/goggles", depends-on = ["build-debug"] }
clean = "rm -rf build"

# Debug Preset
configure-debug = "cmake -B build/debug -G Ninja -DCMAKE_BUILD_TYPE=Debug -DCPM_USE_LOCAL_PACKAGES=ON"
build-debug = { cmd = "cmake --build build/debug", depends-on = ["configure-debug"] }
test-debug = { cmd = "ctest --test-dir build/debug --output-on-failure", depends-on = ["build-debug"] }

# Release Preset
configure-release = "cmake -B build/release -G Ninja -DCMAKE_BUILD_TYPE=Release -DCPM_USE_LOCAL_PACKAGES=ON"
build-release = { cmd = "cmake --build build/release", depends-on = ["configure-release"] }

# ASAN Preset (Debug + AddressSanitizer)
configure-asan = "cmake -B build/asan -G Ninja -DCMAKE_BUILD_TYPE=Debug -DENABLE_ASAN=ON -DCPM_USE_LOCAL_PACKAGES=ON"
build-asan = { cmd = "cmake --build build/asan", depends-on = ["configure-asan"] }
test-asan = { cmd = "ctest --test-dir build/asan --output-on-failure", depends-on = ["build-asan"] }

# Profiling Preset (Release + Tracy)
configure-profile = "cmake -B build/profile -G Ninja -DCMAKE_BUILD_TYPE=Release -DENABLE_PROFILING=ON -DCPM_USE_LOCAL_PACKAGES=ON"
build-profile = { cmd = "cmake --build build/profile", depends-on = ["configure-profile"] }

# Quality Preset (Debug + ASAN + Clang-Tidy)
configure-quality = "cmake -B build/quality -G Ninja -DCMAKE_BUILD_TYPE=Debug -DENABLE_ASAN=ON -DENABLE_CLANG_TIDY=ON -DCPM_USE_LOCAL_PACKAGES=ON"
build-quality = { cmd = "cmake --build build/quality", depends-on = ["configure-quality"] }

[dependencies]
cmake = ">=3.31.2,<5"
ninja = ">=1.13.2,<2"
clang_linux-64 = ">=18"
clangxx_linux-64 = ">=18"
sysroot_linux-64 = ">=2.17"
clang-tools = ">=18"
compiler-rt = ">=18"
libcxx = ">=18"       
spdlog = ">=1.16.0,<2"
catch2 = ">=3.8.0,<4"
toml11 = ">=4.4.0,<5"
libvulkan-headers = ">=1.4.328.1,<2"
xorg-libxcb = ">=1.12,<2"
xorg-libx11 = ">=1.8.12,<2"
xorg-xproto = ">=7.0.31,<8"
wayland = ">=1.24.0,<2"
wayland-protocols = ">=1.47,<2"
libxkbcommon = ">=1.13.1,<2"
alsa-lib = ">=1.2.15.1,<2"
jack = ">=1.9.22,<2"
xorg-libxext = ">=1.3.6,<2"
xorg-libxcursor = ">=1.2.3,<2"
xorg-libxrandr = ">=1.5.4,<2"
xorg-libxi = ">=1.8.2,<2"
xorg-libxscrnsaver = ">=1.2.4,<2"
xorg-libxinerama = ">=1.1.5,<2"
xorg-libxfixes = ">=6.0.2,<7"
xorg-libxrender = ">=0.9.12,<0.10"
xorg-libxau = ">=1.0.12,<2"
xorg-libxdmcp = ">=1.1.5,<2"
xorg-xextproto = ">=7.3.0,<8"
xorg-renderproto = ">=0.11.1,<0.12"
xorg-randrproto = ">=1.5.0,<2"
xorg-inputproto = ">=2.3.2,<3"
xorg-fixesproto = ">=5.0,<6"
xorg-scrnsaverproto = ">=1.2.2,<2"
xorg-xineramaproto = ">=1.2.1,<2"
pulseaudio = ">=17.0,<18"
xorg-kbproto = ">=1.0.7,<2"
xorg-glproto = ">=1.4.17,<2"
libdrm = ">=2.4.125,<3"
sdl3 = ">=3.2.28,<4"
cli11 = ">=2.6.0,<3"
ccache = ">=4.11.3,<5"